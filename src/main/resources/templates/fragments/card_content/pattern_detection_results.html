<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<body>
<th:block th:fragment="standard_results">
    <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
        <div class="mdl-tabs__tab-bar">
            <a href="#table-panel" class="mdl-tabs__tab is-active">Results Table</a>
            <a href="#stats-panel" class="mdl-tabs__tab">Statistics Graph</a>
        </div>

        <!-- Tab 1: Table -->
        <div class="mdl-tabs__panel is-active" id="table-panel">
            <table id="results-table" class="display" style="width:100%">
                <thead>
                <tr>
                    <th>Trace ID</th>
                    <th>Detected Pattern</th>
                    <th>Occurrences Length</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="result : ${results}" >
                    <td th:text="${result.traceID}"></td>
                    <td >2</td>
                    <td th:text="${#lists.size(result.occurrences)}"></td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- Tab 2: Graph -->
        <div class="mdl-tabs__panel" id="stats-panel">
<!--            <canvas id="statsChart" width="400" height="200"></canvas>-->
        </div>
    </div>

</th:block>

<div th:fragment="error_panel"

     th:if="${not #lists.isEmpty(nonExistingPairs) or not #lists.isEmpty(constraintsNotFulfilled) or not #lists.isEmpty(nonExistingEvents) or not #lists.isEmpty(wrongConstraints)}"
     style="border: 1px solid #e57373; background-color: #ffebee; padding: 1rem; border-radius: 8px; margin-top: 1rem; color: #b71c1c;">

    <div th:if="${nonExistingPairs}">
        <h6>⚠️ Pairs of events that do not exist in the database</h6>
        <ul>
            <li th:each="pair : ${nonExistingPairs}">
                <div style="align-items: center; display: flex;">
                    <span style="display: inline-block;" th:text="${pair.eventA.name}">A</span>
                    <span style="font-size: 24px;margin-bottom: 8px;">&#8594;</span>
                    <span style="display: inline-block;" th:text="${pair.eventB.name}">B</span>
                </div>
            </li>
        </ul>
    </div>

    <div th:if="${constraintsNotFulfilled}">
        <h4>⚠️ Constraints that cannot be fulfilled</h4>
        <ul>
            <li th:each="pair : ${constraintsNotFulfilled}">
                Constraint between <span th:text="${pair.eventA.name}">A</span> and <span th:text="${pair.eventB.name}">B</span>
            </li>
        </ul>
    </div>

    <div th:if="${nonExistingEvents}">
        <h4>⚠️ Events not found in database</h4>
        <ul>
            <li th:each="ev : ${nonExistingEvents}" th:text="${ev}">event-name</li>
        </ul>
    </div>

    <div th:if="${wrongConstraints}">
        <h4>⚠️ Constraints with errors</h4>
        <ul>
            <li th:each="c : ${wrongConstraints}">
                <span th:switch="${c.method}">
                    <span th:case="'atleast'">
                        At least constraint between <span th:text="${c.posA}">A</span> and <span th:text="${c.posB}">B</span>
                        with <span th:text="${#fields.safeObject(c.constraint)}"></span>
                        <span th:text="${#fields.safeObject(c.granularity)}"></span>
                    </span>
                    <span th:case="'within'">
                        Within constraint between <span th:text="${c.posA}">A</span> and <span th:text="${c.posB}">B</span>
                        with <span th:text="${#fields.safeObject(c.constraint)}"></span>
                        <span th:text="${#fields.safeObject(c.granularity)}"></span>
                    </span>
                    <span th:case="*">
                        Unknown constraint type on positions <span th:text="${c.posA}"></span> and <span th:text="${c.posB}"></span>
                    </span>
                </span>
            </li>
        </ul>
    </div>
</div>

<th:block th:fragment="group_results">
    <p>No query has been submitted yet.</p>
</th:block>

</body>
</html>